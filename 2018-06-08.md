---

title: 微信小程序填坑
date: 2018-06-08 17:24:22
categories: 文章分类
tags: 文章标签

---
### 微信小程序体验版问题
#### 微信小程序在公众平台上发布体验版本，添加体验者后，体验者必须打开调试才可以访问接口，正常发送请求。
### 微信小程序全局设置
<!--more-->
#### 微信小程序全局变量可以在page根目录下page.js中的globalData属性中声明，globalData是一个对象，里面以键值对的形式存在。
#### 如下可以声明一个全局的变量用来调用接口：
```
globalData:{
  userInfo:null,
  host:'http://www.wsspha.cn/blogs'
}
```
##### host就是一个全局的变量在小程序的各个子模块中都可以通过getApp().globalData.host调用，设置全局变量可以方便测试和正式服务器调试，只需改变全家变量就可以了。当然全局变量还有很多用到的地方，要看业务需求。
page.json是一个对象，里面json格式，pages数组里面可以认为是路由就是我们所说的页面，也就是各个模块的命名以及路径。另一个window是整个小程序的顶部的title的一些设置，可以查看官网文档进行设置。
所有page根目录下的配置文件都是针对的全局的设置。pages下面的所有模块也有page.js、page.json、page.wxss、page.wxml。当然名字是自己在根目录的page.json中定义的，可以快捷的生成一个模块，不需要在编辑器中一个个新建。并且模块的配置文件优先级大于全局的。
## 微信小程序在css中使用背景图片的问题
小程序中如果在css中使用背景图片，目前为止如果审核通过后会出现图片无法显示的问题，官方给的就是图片要么使用base64转码，或者直接使用服务器上的图片，不能使用本地的，虽然在开发者工具中可以显示正常，但是代码审核后却不显示。
## 微信小程序map地图使用踩坑。
map组件以及canvas等一些原生组件都是层级最高的，虽然在编辑器ide上设置z-index可以盖住地图，但是在真机上却是被地图遮住，所以想做浮层的时候会有很大的问题，可以通过把浮层出来的时候把地图hidden，想要用腾讯或者高德百度的sdk的话需要在微信公众平台的设置里面添加request合法域名才能在真机上调用sdk的方法。
## 提交「小程序」时需要注意的地方，避免悲剧。
1、小程序的名称必须和所提供的服务有所关联，而且必须是两个词以上的组合，不能使用广泛使用不具备识别性的词语来命名，比如日历、电话。
2、提交小程序审查时，头像 LOGO 要尽量使用清晰度高的图片，这个清晰度是指可以看清、分别、图片中包含的元素，否则微信不予通过。
3、微信希望，用户打开小程序的时候直接就能使用到相关的功能，因此这份文档提到，用户在小程序的页面就能使用到相关的服务，不能隐藏，也不能进行多次跳转。有特别规定，「小程序首页必须能够直达或者经过 2 次点击到达」相关的功能。
4、小程序的功能不能过于简单，比如说只有一个页面，或只提供一个按钮。
5、小程序不能展示、推荐第三方小程序，不能做小程序导航、互推、小程序排行榜等。也不能通过小程序来搜索其它小程序。
6、用户使用小程序时，不能以关注或使用其它小程序作为条件。
7、禁止诱导分享，这个不用再说，微信对此一直严厉打压。
8、小程序不能用作营销活动、广告用途，不能存在类似算命、星座运势之类的测试类内容，不能包含赌博竞猜抽奖等内容。
9、小程序里面的图片，不能包含广告、网址。
## 运营「小程序」的时候，需要注意哪些地方，才不会下架？
1、微信不允许批量注册、重复提交大量类似的小程序。
2、小程序的添加，不能设置付费，必须是免费添加。
3、如果你的微信小程序含有支付功能，需要在简介当中明确指示。
4、如果你希望通过小程序创业，需要注意：如果小程序所属的公司被收购或合并，你从微信和微信小程序接收的小程序里继续使用。
5、如果小程序使用到地理位置定位功能，在采集、 获取用户地理位置时必须得到用户的同意。
6、小程序后台服务，仅限于集中目的：VoIP、音频播放、地理位置、完成任务和本地提醒。
7、禁止多媒体比如音频、视频的自动播放。
## 结语
微信小程序并不难，上手很快和vue挺像的，因为很多东西微信都已经封装好了，只需要调方法就行了，由于项目做了几个月，一些坑也记不太清了。
